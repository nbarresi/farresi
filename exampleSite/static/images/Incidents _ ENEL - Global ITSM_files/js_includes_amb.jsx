/*! RESOURCE: /scripts/js_includes_amb.js */
/*! RESOURCE: /scripts/glide-amb-client-bundle.min.js */
!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var t=n();for(var i in t)("object"==typeof exports?exports:e)[i]=t[i]}}("undefined"!=typeof self?self:this,function(){return function(e){var n={};function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=11)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,r=(i=t(1))&&i.__esModule?i:{default:i};var o=function(e){function n(n){window.console&&console.log(e+" "+n)}return{debug:function(e){"debug"===r.default.logLevel&&n("[DEBUG] "+e)},addInfoMessage:function(e){n("[INFO] "+e)},addErrorMessage:function(e){n("[ERROR] "+e)},addWarnMessage:function(e){n("[WARN] "+e)}}};n.default=o},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.TOKEN_MANAGEMENT_EXTENSION=n.WEBSOCKET_TYPE_NAME=void 0;n.WEBSOCKET_TYPE_NAME="websocket";n.TOKEN_MANAGEMENT_EXTENSION="tokenManagementExtension";var i={servletPath:"amb",logLevel:"info",loginWindow:"true",wsConnectTimeout:1e4,overlayStyle:"",subscribeCommandsFlow:{enable:!1,maxInflight:1,maxWait:1e4,retries:3,retryDelay:{min:2e3,max:3e5,increaseFactor:2}}};n.default=i},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,r=(i=t(0))&&i.__esModule?i:{default:i};var o=function(e,n,t){var i,o,s=new r.default("amb.ChannelListener"),a=e;return{getCallback:function(){return o},getSubscriptionCallback:function(){return t},getID:function(){return i},setNewChannel:function(e){a.unsubscribe(this),a=e,this.subscribe(o)},subscribe:function(e){return o=e,i=a.subscribe(this),this},resubscribe:function(){return this.subscribe(o)},unsubscribe:function(){return a.unsubscribe(this),s.debug("Unsubscribed from channel: "+a.getName()),this},publish:function(e){a.publish(e)},getName:function(){return a.getName()}}};n.default=o},function(e,n,t){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.isEmptyObject=n.isObject=n.isNil=n.isNull=n.isUndefined=void 0;var r=function(e){return void 0===e};n.isUndefined=r;var o=function(e){return null===e};n.isNull=o;n.isNil=function(e){return o(e)||r(e)};var s=function(e){return null!=e&&"object"===i(e)};n.isObject=s;n.isEmptyObject=function(e){return s(e)&&0===Object.keys(e).length}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(e){var n=[],t=0;return{subscribe:function(e,i){var r=t++;return n.push({event:e,callback:i,id:r}),r},unsubscribe:function(e){for(var t=0;t<n.length;t++)e===n[t].id&&n.splice(t,1)},publish:function(e,n){for(var t=this._getSubscriptions(e),i=0;i<t.length;i++)t[i].callback.apply(null,n)},getEvents:function(){return e},_getSubscriptions:function(e){for(var t=[],i=0;i<n.length;i++)n[i].event===e&&t.push(n[i]);return t}}};n.default=i},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=h(t(4)),r=h(t(0)),o=function(e){if(e&&e.__esModule)return e;var n=d();if(n&&n.has(e))return n.get(e);var t={};if(null!=e){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=i?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(t,r,o):t[r]=e[r]}}t.default=e,n&&n.set(e,t);return t}(t(1)),s=h(t(6)),a=h(t(7)),u=h(t(19)),c=t(3),l=h(t(20)),f=h(t(21));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.default,t=!1,d=!1,h=new i.default({CONNECTION_INITIALIZED:"connection.initialized",CONNECTION_OPENED:"connection.opened",CONNECTION_CLOSED:"connection.closed",CONNECTION_BROKEN:"connection.broken",SESSION_LOGGED_IN:"session.logged.in",SESSION_LOGGED_OUT:"session.logged.out",SESSION_INVALIDATED:"session.invalidated",SESSION_REESTABLISHED:"session.reestablished"}),g={SESSION_LOGGED_IN:"session.logged.in",SESSION_LOGGED_OUT:"session.logged.out",SESSION_INVALIDATED:"session.invalidated"},b="closed",p={},v=new r.default("amb.ServerConnection");!function(){e.addListener("/meta/handshake",this,R),e.addListener("/meta/connect",this,G),e.addListener("/meta/subscribe",this,U),e.addListener("/meta/unsubscribe",this,U)}();var m=g.SESSION_INVALIDATED,y=null,_="true"===o.default.loginWindow,C=null,w={UNKNOWN_CLIENT:"402::Unknown client"},T=!1,S={},E=!1,x=new s.default(e,S),k=!1,O="glide.amb.session.logout.overlay.style",I="glide.session.status",N="session.touch.http",L="amb.ServerConnection.reestablish.session",M=e.getExtension(o.TOKEN_MANAGEMENT_EXTENSION),D=null;function R(e){var n=A(e,O);n&&(o.default.overlayStyle=n),m=A(e,I),function(e){if(e.ext){var n=e.ext.subscribeCommandsFlow;if(n){var t,i,r,s=o.default.subscribeCommandsFlow;if(o.default.subscribeCommandsFlow.enable=(t=n.enable,i=s.enable,r=i,(0,c.isNil)(t)||(r=!!t),r),o.default.subscribeCommandsFlow.enable){o.default.subscribeCommandsFlow.retries=P(n.retries,s.retries),o.default.subscribeCommandsFlow.maxInflight=P(n.maxInflight,s.maxInflight),o.default.subscribeCommandsFlow.maxWait=P(n.maxWait,s.maxWait);var a=n.retryDelay;if(a){var u=o.default.subscribeCommandsFlow.retryDelay;o.default.subscribeCommandsFlow.retryDelay.min=P(a.min,u.min),o.default.subscribeCommandsFlow.retryDelay.max=P(a.max,u.max),o.default.subscribeCommandsFlow.retryDelay.increaseFactor=P(a.increaseFactor,u.increaseFactor)}}o.default.subscribeCommandsFlow.enable&&(v.addInfoMessage("_initializeSubscriptionCommandSender: SubscriptionCommandSender is enabled"),null!=M&&M.updateTokenCount(o.default.subscribeCommandsFlow.maxInflight),D&&D.stop(),D=new f.default(new l.default(1e4),M))}}}(e),setTimeout(function(){e.successful&&W()},0)}function A(e,n){if((0,c.isObject)(e.ext))return e.ext[n]}function F(n,t){if(n in p)return p[n];var i=new a.default(e,n,k,t);return p[n]=i,i}function B(e){delete p[e]}function U(n){if(n.ext){!1===n.ext["glide.amb.active"]&&S.disconnect();var t=A(n,"glide.amb.client.log.level");t&&(o.default.logLevel=t,e.setLogLevel(o.default.logLevel))}}function P(e,n){var t=Math.floor(parseInt(e));return(isNaN(t)||t<0)&&(t=n),t}function j(){for(var e in v.debug("Resubscribing to all!"),p){var n=p[e];n&&n.resubscribeToCometD()}}function q(){for(var e in v.debug("Unsubscribing from all!"),p){var n=p[e];n&&n.unsubscribeFromCometD()}}function G(n){if(U(n),d)setTimeout(function(){t=!1,v.debug("Connection closed"),b="closed",X(h.getEvents().CONNECTION_CLOSED)},0);else{var i=A(n,N);o.WEBSOCKET_TYPE_NAME===e.getTransport().getType()&&!0===i&&S._touchHttpSession();var r=n.error;r&&(C=r),function(e){var n=A(e,I);n&&n!==m&&(T=!0===A(e,"glide.amb.login.window.override"),Q(n))}(n);var s=t;t=!0===n.successful,!s&&t?H():s&&!t&&(v.addErrorMessage("Connection broken"),b="broken",E=!0,X(h.getEvents().CONNECTION_BROKEN),D&&(D.stop(),D=null))}}function W(){v.debug("Connection initialized"),k=!0,b="initialized",X(h.getEvents().CONNECTION_INITIALIZED)}function H(){v.debug("Connection opened"),E?S.getLastError()===S.getErrorMessages().UNKNOWN_CLIENT&&(S.setLastError(null),S._sendSessionSetupRequest(function(e){var n=e.status;200===n&&(E=!1,x.initialize(z))})):x.initialize(z)}function z(){j(),b="opened",X(h.getEvents().CONNECTION_OPENED)}function Q(e){v.debug("session.status - "+e),function(e){return(m===g.SESSION_LOGGED_IN||m===g.SESSION_LOGGED_OUT)&&e===g.SESSION_INVALIDATED}(e)?(v.debug("INVALIDATED event fire!"),q(),X(h.getEvents().SESSION_INVALIDATED)):function(e){return m===g.SESSION_LOGGED_IN&&e===g.SESSION_LOGGED_OUT}(e)?(v.debug("LOGGED_OUT event fire!"),q(),X(h.getEvents().SESSION_LOGGED_OUT),_&&!T&&S.loginShow()):function(e){return m===g.SESSION_INVALIDATED&&e===g.SESSION_LOGGED_OUT}(e)?(v.debug("REESTABLISHED event fire!"),j(),X(h.getEvents().SESSION_REESTABLISHED)):function(e){return(m===g.SESSION_INVALIDATED||m===g.SESSION_LOGGED_OUT)&&e===g.SESSION_LOGGED_IN}(e)&&(v.debug("LOGGED_IN event fire!"),j(),X(h.getEvents().SESSION_LOGGED_IN),S.loginHide()),m=e}function X(e){try{h.publish(e)}catch(n){v.addErrorMessage("error publishing '"+e+"' - "+n)}}return S.connect=function(){t?v.debug(">>> connection exists, request satisfied"):(v.debug("Connecting to glide amb server -> "+o.default.servletURI),e.configure({url:S.getURL(o.default.servletPath),logLevel:o.default.logLevel,connectTimeout:o.default.wsConnectTimeout}),e.handshake(),n.on(L,function(){S._reestablishSession(!1)}))},S.reload=function(){e.reload()},S.abort=function(){e.getTransport().abort()},S.disconnect=function(){v.debug("Disconnecting from glide amb server.."),d=!0,e.disconnect()},S.getURL=function(e){return window.location.protocol+"//"+window.location.host+"/"+e},S.unsubscribeAll=function(){q()},S.resubscribeAll=function(){j()},S.removeChannel=function(e){B(e)},S.getEvents=function(){return h.getEvents()},S.getConnectionState=function(){return b},S.getLastError=function(){return C},S.setLastError=function(e){C=e},S.getErrorMessages=function(){return w},S.isLoggedIn=function(){return m===g.SESSION_LOGGED_IN},S.isSessionActive=function(){return m!==g.SESSION_INVALIDATED},S.getChannelRedirect=function(){return x},S.getChannel=function(e,n){return F(e,n)},S.getChannels=function(){return p},S.getState=function(){return b},S.getLoginWindowOverlayStyle=function(){return o.default.overlayStyle},S.loginShow=function(){v.debug("Show login window");var e='<iframe src="/amb_login.do" frameborder="0" height="400px" width="405px" scrolling="no"></iframe>',n='<div id="amb_disconnect_modal" tabindex="-1" aria-hidden="true" class="modal" role="dialog" style="'.concat(o.default.overlayStyle,'">\n\t\t\t\t<div class="modal-dialog small-modal" style="width:450px">\n\t\t\t\t   <div class="modal-content">\n\t\t\t\t\t  <header class="modal-header">\n\t\t\t\t\t\t <h4 id="small_modal1_title" class="modal-title">Login</h4>\n\t\t\t\t\t  </header>\n\t\t\t\t\t  <div class="modal-body">\n\t\t\t\t\t  </div>\n\t\t\t\t   </div>\n\t\t\t\t</div>\n\t\t\t</div>');try{var t=new GlideModal("amb_disconnect_modal");t.renderWithContent?(t.template=n,t.renderWithContent(e)):(t.setBody(e),t.render()),y=t}catch(e){v.debug(e)}},S.loginHide=function(){y&&(y.destroy(),y=null)},S.loginComplete=function(){S.reestablishSession()},S.reestablishSession=function(){S._reestablishSession(!0)},S.subscribeToEvent=function(e,n){return h.getEvents().CONNECTION_OPENED===e&&t&&n(),h.subscribe(e,n)},S.unsubscribeFromEvent=function(e){h.unsubscribe(e)},S.isLoginWindowEnabled=function(){return _},S.setLoginWindowEnabled=function(e){_=e},S.isLoginWindowOverride=function(){return T},S.getSubscriptionCommandSender=function(){return D},S._metaConnect=G,S._metaHandshake=R,S._sendSessionSetupRequest=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=function(){v.debug("sending /amb_session_setup.do!");var n=new XMLHttpRequest;return n.open("POST","/amb_session_setup.do",!0),n.setRequestHeader("Content-type","application/json;charset=UTF-8"),n.setRequestHeader("X-UserToken",window.g_ck),n.setRequestHeader("X-CometD_SessionID",e.getClientId()),n}();t.onload=function(){return n(t)},t.send()},S._onChannelRedirectSubscriptionComplete=z,S._getChannel=F,S._removeChannel=B,S._connectionInitialized=W,S._connectionOpened=H,S._reestablishSession=function(e){S._sendSessionSetupRequest(function(e){var n=e.response;n&&Q(JSON.parse(n)["glide.session.status"])}),e&&n.emit(L,L)},S._touchHttpSession=function(){var e=new XMLHttpRequest;e.open("POST","/amb",!0),e.setRequestHeader("Content-type","application/json"),e.send()},S};n.default=g},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t(0)),r=o(t(2));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(e,n){var t,o=e,s=new i.default("amb.ChannelRedirect");function a(e){s.debug("_onAdvice:"+e.data.clientId);var t=n.getChannel(e.data.fromChannel),i=n.getChannel(e.data.toChannel);t&&i?(function(e,n){for(var t=e.getChannelListeners(),i=0;i<t.length;i++)t[i].setNewChannel(n)}(t,i),s.debug("published channel switch event, fromChannel:"+t.getName()+", toChannel:"+i.getName())):s.debug("Could not redirect from "+e.data.fromChannel+" to "+e.data.toChannel)}return{initialize:function(e){var i="/sn/meta/channel_redirect/"+o.getClientId(),u=n.getChannel(i);t&&u===t?t.subscribeToCometD():(t&&n.removeChannel(t.getName()),t=u,new r.default(t,n,e).subscribe(a)),s.debug("ChannelRedirect initialized: "+i)},_onAdvice:a}};n.default=s},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t(0)),r=t(3),o=s(t(8));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e,n,t){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return{}},a=null,u=null,c=[],l=[],f=new i.default("amb.Channel"),d=0,h=t;function g(){return(0,o.default)().getServerConnection().getSubscriptionCommandSender()}return{subscribe:function(e){if(e.getCallback()){for(var t=0;t<c.length;t++)if(c[t]===e)return f.debug("Channel listener already in the list"),e.getID();c.push(e);var i=e.getSubscriptionCallback();if(i&&(u?i(u):l.push(i)),!a&&h)try{this.subscribeToCometD()}catch(e){return void f.addErrorMessage(e)}return++d}f.addErrorMessage("Cannot subscribe to channel: "+n+", callback not provided")},resubscribe:function(){a=null;for(var e=0;e<c.length;e++)c[e].resubscribe()},_handleResponse:function(e){for(var n=0;n<c.length;n++)c[n].getCallback()(e)},unsubscribe:function(t){if(t){for(var i=0;i<c.length;i++)if(c[i].getID()===t.getID()){c.splice(i,1);break}var r;c.length<1&&a&&"disconnecting"!==(r=e.getStatus())&&"disconnected"!==r&&this.unsubscribeFromCometD()}else f.addErrorMessage("Cannot unsubscribe from channel: "+n+", listener argument does not exist")},publish:function(t){e.publish(n,t)},subscribeToCometD:function(){f.debug("subscribeToCometD channelName : "+n+", subscription : "+a),g()?g().subscribeToChannel(this):this._subscribeToCometD(this.subscriptionCallback)},_subscribeToCometD:function(t){f.debug("_subscribeToCometD channelName : "+n);var i=s();if((0,r.isNil)(i)||(0,r.isEmptyObject)(i))a=e.subscribe(n,this._handleResponse.bind(this),t);else{var o={subscribeOptions:i};a=e.subscribe(n,this._handleResponse.bind(this),o,t)}f.debug("Successfully subscribed to channel: "+n+", Subscribe options: "+i)},subscriptionCallback:function(e){f.debug("Cometd subscription callback completed for channel: "+n),f.debug("Listener callback queue size: "+l.length),u=e,l.map(function(e){e(u)}),l=[]},unsubscribeFromCometD:function(){f.debug("unsubscribeFromCometD  from : "+n+", subscription : "+a),null!==a&&(g()?g().unsubscribeToChannel(this):this._unsubscribeFromCometD())},_unsubscribeFromCometD:function(){f.debug("_unsubscribeFromCometD  from : "+n+", subscription : "+a),null!==a&&(e.unsubscribe(a),a=null,u=null,f.debug("Successfully unsubscribed from channel: "+n))},resubscribeToCometD:function(){f.debug("Resubscribe to "+n),g()?g().subscribeToChannel(this):this._subscribeToCometD(this.subscriptionCallback)},getSubscribeOptionsCallback:function(){return s},getName:function(){return n},getChannelListeners:function(){return c},getListenerCallbackQueue:function(){return l},setSubscriptionCallbackResponse:function(e){u=e}}};n.default=a},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t(9)),r=s(t(17)),o=s(t(18));function s(e){return e&&e.__esModule?e:{default:e}}function a(e){return e.MSInputMethodContext&&e.document.documentMode}function u(e,n){if(void 0!==e.getClientWindow&&e.getClientWindow()===n)return e;var t=function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}({},e);return t.getChannel=function(t,i,r){return e.getChannel(t,i,r||n)},t.getRecordWatcherChannel=function(t,i,r,o,s){return e.getRecordWatcherChannel(t,i,r,o,s||n)},t.subscribeToEvent=function(t,i,r){return e.subscribeToEvent(t,i,r||n)},t.unsubscribeFromEvent=function(t,i){return e.unsubscribeFromEvent(t,i||n)},t.getClientWindow=function(){return n},t}var c=function(){var e=function(e){try{if(!a(e))for(;e!==e.parent&&!e.g_ambClient;)e=e.parent;if(e.g_ambClient)return e.g_ambClient}catch(e){console.log("AMB getClient() tried to access parent from an iFrame. Caught error: "+e)}return null}(window);e||function(e){var n=window.self;n.g_ambClient=e,n.addEventListener("unload",function(){n.g_ambClient.disconnect()}),"complete"===(n.document?n.document.readyState:null)?i():n.addEventListener("load",i),setTimeout(i,1e4);var t=!1;function i(){t||(t=!0,n.g_ambClient.connect())}}(e=u(function(e){return n=new i.default,t=function(){var e=[];function n(e,n,i){if(e&&i){var r=t(e);if(r)for(var o=r.subscriptions,s=o.length-1;s>=0;s--)o[s].id===n&&o[s].callback===i&&o.splice(s,1)}}function t(n){for(var t=0,i=e.length;t<i;t++)if(e[t].window===n)return e[t];return null}function i(n){var t={window:n,onUnload:function(){t.unloading=!0;for(var n,i=t.subscriptions;n=i.pop();)n.unsubscribe();!function(n){for(var t=0,i=e.length;t<i;t++)if(e[t].window===n.window){e.splice(t,1);break}n.subscriptions=[],n.window.removeEventListener("unload",n.onUnload),n.onUnload=null,n.window=null}(t)},unloading:!1,subscriptions:[]};return n.addEventListener("unload",t.onUnload),e.push(t),t}return{add:function(e,r,o,s){if(e&&o&&s){n(e,r,o);var a=t(e);a||(a=i(e)),a.unloading||a.subscriptions.push({id:r,callback:o,unsubscribe:s})}},remove:n}}(),s=n.getServerConnection(),e&&s.setLoginWindowEnabled(!1),{getServerConnection:function(){return s},connect:function(){n.connect()},abort:function(){n.abort()},disconnect:function(){n.disconnect()},getConnectionState:function(){return n.getConnectionState()},getState:function(){return n.getConnectionState()},getClientId:function(){return n.getClientId()},getChannel:function(e,i,r){var o=n.getChannel(e,i),a=o.subscribe,u=o.unsubscribe;return r=r||window,o.subscribe=function(i){return t.add(r,o,i,function(){o.unsubscribe(i)}),r.addEventListener("unload",function(){n.removeChannel(e)}),a.call(o,i),o},o.unsubscribe=function(i){t.remove(r,o,i);var a=u.call(o,i);return 0===s.getChannel(e).getChannelListeners().length&&n.removeChannel(e),a},o},getChannel0:function(e,t){return n.getChannel(e,t)},getRecordWatcherChannel:function(e,n,t,i,s){var a=r.default.stringify(o.default.parse(n)).replace(/=/g,"-");return t=t||"default",this.getChannel("/rw/"+t+"/"+e+"/"+a,i,s)},registerExtension:function(e,t){n.registerExtension(e,t)},unregisterExtension:function(e){n.unregisterExtension(e)},batch:function(e){n.batch(e)},subscribeToEvent:function(e,i,r){r=r||window;var o=n.subscribeToEvent(e,i);return t.add(r,o,!0,function(){n.unsubscribeFromEvent(o)}),o},unsubscribeFromEvent:function(e,i){i=i||window,t.remove(i,e,!0),n.unsubscribeFromEvent(e)},isLoggedIn:function(){return n.isLoggedIn()},getConnectionEvents:function(){return n.getConnectionEvents()},getEvents:function(){return n.getConnectionEvents()},reestablishSession:function(){n.reestablishSession()},loginComplete:function(){n.loginComplete()},getChannels:function(){return n.getChannels()},extendSession:function(){return n.extendSession()},getTokenManagementExtension:function(){return n.getTokenManagementExtension()}};var n,t,s}(a(window)&&null!==window.frameElement),window));return u(e,window)};n.default=c},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=f(t(13)),r=f(t(5)),o=f(t(0)),s=f(t(2)),a=f(t(14)),u=t(1),c=f(t(15)),l=f(t(16));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(){var e=new i.default.CometD;e.registerTransport(u.WEBSOCKET_TYPE_NAME,new i.default.WebSocketTransport,0),e.registerTransport("long-polling",new i.default.LongPollingTransport,1),e.unregisterTransport("callback-polling");var n=new a.default;e.registerExtension("graphQLSubscription",n);var t=new c.default;e.registerExtension("sessionExtension",t);var f=new l.default;e.registerExtension(u.TOKEN_MANAGEMENT_EXTENSION,f);var d=new r.default(e),h=new o.default("amb.MessageClient"),g=!1;return{getServerConnection:function(){return d},isLoggedIn:function(){return d.isLoggedIn()},loginComplete:function(){d.loginComplete()},reestablishSession:function(){d.reestablishSession()},connect:function(){g?h.addInfoMessage(">>> connection exists, request satisfied"):(g=!0,d.connect())},reload:function(){g=!1,d.reload()},abort:function(){g=!1,d.abort()},disconnect:function(){g=!1,d.disconnect()},isConnected:function(){return g},getConnectionEvents:function(){return d.getEvents()},subscribeToEvent:function(e,n){return d.subscribeToEvent(e,n)},unsubscribeFromEvent:function(e){d.unsubscribeFromEvent(e)},getConnectionState:function(){return d.getConnectionState()},getClientId:function(){return e.getClientId()},getChannel:function(e,t){var i=t||{},r=i.subscriptionCallback,o=i.serializedGraphQLSubscription,a=i.subscribeOptionsCallback,u=d.getChannel(e,a);return n.isGraphQLChannel(e)&&(o?n.addGraphQLChannel(e,o):h.addErrorMessage("Serialized subscription not present for GraphQL channel "+e)),new s.default(u,d,r)},removeChannel:function(e){d.removeChannel(e),n.isGraphQLChannel(e)&&n.removeGraphQLChannel(e)},getChannels:function(){return d.getChannels()},extendSession:function(){t.extendSession()},getTokenManagementExtension:function(){return f},registerExtension:function(n,t){e.registerExtension(n,t)},unregisterExtension:function(n){e.unregisterExtension(n)},batch:function(n){e.batch(n)}}};n.default=d},function(e,n,t){var i;i=function(){var e=e||function(e,n){var t=Object.create||function(){function e(){}return function(n){var t;return e.prototype=n,t=new e,e.prototype=null,t}}(),i={},r=i.lib={},o=r.Base={extend:function(e){var n=t(this);return e&&n.mixIn(e),n.hasOwnProperty("init")&&this.init!==n.init||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=r.WordArray=o.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=void 0!=n?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var n=this.words,t=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var o=0;o<r;o++){var s=t[o>>>2]>>>24-o%4*8&255;n[i+o>>>2]|=s<<24-(i+o)%4*8}else for(o=0;o<r;o+=4)n[i+o>>>2]=t[o>>>2];return this.sigBytes+=r,this},clamp:function(){var n=this.words,t=this.sigBytes;n[t>>>2]&=4294967295<<32-t%4*8,n.length=e.ceil(t/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(n){for(var t,i=[],r=function(n){n=n;var t=987654321,i=4294967295;return function(){var r=((t=36969*(65535&t)+(t>>16)&i)<<16)+(n=18e3*(65535&n)+(n>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},o=0;o<n;o+=4){var a=r(4294967296*(t||e.random()));t=987654071*a(),i.push(4294967296*a()|0)}return new s.init(i,n)}}),a=i.enc={},u=a.Hex={stringify:function(e){for(var n=e.words,t=e.sigBytes,i=[],r=0;r<t;r++){var o=n[r>>>2]>>>24-r%4*8&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i+=2)t[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(t,n/2)}},c=a.Latin1={stringify:function(e){for(var n=e.words,t=e.sigBytes,i=[],r=0;r<t;r++){var o=n[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(o))}return i.join("")},parse:function(e){for(var n=e.length,t=[],i=0;i<n;i++)t[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(t,n)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},f=r.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(n){var t=this._data,i=t.words,r=t.sigBytes,o=this.blockSize,a=r/(4*o),u=(a=n?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*o,c=e.min(4*u,r);if(u){for(var l=0;l<u;l+=o)this._doProcessBlock(i,l);var f=i.splice(0,u);t.sigBytes-=c}return new s.init(f,c)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(r.Hasher=f.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,t){return new e.init(t).finalize(n)}},_createHmacHelper:function(e){return function(n,t){return new d.HMAC.init(e,t).finalize(n)}}}),i.algo={});return i}(Math);return e},e.exports=i()},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"amb",{enumerable:!0,get:function(){return r.default}});var i,r=(i=t(12))&&i.__esModule?i:{default:i}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=d(t(1)),r=d(t(0)),o=d(t(4)),s=d(t(5)),a=d(t(6)),u=d(t(2)),c=d(t(7)),l=d(t(9)),f=d(t(8));function d(e){return e&&e.__esModule?e:{default:e}}var h={properties:i.default,Logger:r.default,EventManager:o.default,ServerConnection:s.default,ChannelRedirect:a.default,ChannelListener:u.default,Channel:c.default,MessageClient:l.default,getClient:f.default};n.default=h},function(e,n,t){var i;i=function(){var e={isString:function(e){return void 0!==e&&null!==e&&("string"==typeof e||e instanceof String)},isArray:function(e){return void 0!==e&&null!==e&&e instanceof Array},inArray:function(e,n){for(var t=0;t<n.length;++t)if(e===n[t])return t;return-1},setTimeout:function(e,n,t){return window.setTimeout(function(){try{e._debug("Invoking timed function",n),n()}catch(t){e._debug("Exception invoking timed function",n,t)}},t)},clearTimeout:function(e){window.clearTimeout(e)}},n=function(){var n,t,i;this.registered=function(e,i){n=e,t=i},this.unregistered=function(){n=null,t=null},this._debug=function(){t._debug.apply(t,arguments)},this._mixin=function(){return t._mixin.apply(t,arguments)},this.getConfiguration=function(){return t.getConfiguration()},this.getAdvice=function(){return t.getAdvice()},this.setTimeout=function(n,i){return e.setTimeout(t,n,i)},this.clearTimeout=function(n){e.clearTimeout(n)},this.convertToMessages=function(n){if(e.isString(n))try{return JSON.parse(n)}catch(e){throw this._debug("Could not convert to JSON the following string",'"'+n+'"'),e}if(e.isArray(n))return n;if(void 0===n||null===n)return[];if(n instanceof Object)return[n];throw"Conversion Error "+n+", typeof "+typeof n},this.accept=function(e,n,t){throw"Abstract"},this.getType=function(){return n},this.getURL=function(){return i},this.setURL=function(e){i=e},this.send=function(e,n){throw"Abstract"},this.reset=function(e){this._debug("Transport",n,"reset",e?"initial":"retry")},this.abort=function(){this._debug("Transport",n,"aborted")},this.toString=function(){return this.getType()}};n.derive=function(e){function n(){}return n.prototype=e,new n};var t=function(){var t=new n,i=n.derive(t),r=0,o=null,s=[],a=[];function u(e,n){if(this.transportSend(e,n),n.expired=!1,!e.sync){var t=this.getConfiguration().maxNetworkDelay,i=t;!0===n.metaConnect&&(i+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",i,"ms for the response, maxNetworkDelay",t);var r=this;n.timeout=this.setTimeout(function(){n.expired=!0;var t="Request "+n.id+" of transport "+r.getType()+" exceeded "+i+" ms max network delay",o={reason:t},s=n.xhr;o.httpCode=r.xhrStatus(s),r.abortXHR(s),r._debug(t),r.complete(n,!1,n.metaConnect),e.onFailure(s,e.messages,o)},i)}}function c(e){var n=++r,t={id:n,metaConnect:!1,envelope:e};s.length<this.getConfiguration().maxConnections-1?(s.push(t),u.call(this,e,t)):(this._debug("Transport",this.getType(),"queueing request",n,"envelope",e),a.push([e,t]))}function l(n,t){var i=e.inArray(n,s);if(i>=0&&s.splice(i,1),a.length>0){var r=a.shift(),o=r[0],u=r[1];if(this._debug("Transport dequeued request",u.id),t)this.getConfiguration().autoBatch&&function(e){for(;a.length>0;){var n=a[0],t=n[0],i=n[1];if(t.url!==e.url||t.sync!==e.sync)break;a.shift(),e.messages=e.messages.concat(t.messages),this._debug("Coalesced",t.messages.length,"messages from request",i.id)}}.call(this,o),c.call(this,o),this._debug("Transport completed request",n.id,o);else{var l=this;this.setTimeout(function(){l.complete(u,!1,u.metaConnect);var e={reason:"Previous request failed"},n=u.xhr;e.httpCode=l.xhrStatus(n),o.onFailure(n,o.messages,e)},0)}}}return i.complete=function(e,n,t){t?function(e){var n=e.id;if(this._debug("Transport",this.getType(),"metaConnect complete, request",n),null!==o&&o.id!==n)throw"Longpoll request mismatch, completing request "+n;o=null}.call(this,e):l.call(this,e,n)},i.transportSend=function(e,n){throw"Abstract"},i.transportSuccess=function(e,n,t){n.expired||(this.clearTimeout(n.timeout),this.complete(n,!0,n.metaConnect),t&&t.length>0?e.onSuccess(t):e.onFailure(n.xhr,e.messages,{httpCode:204}))},i.transportFailure=function(e,n,t){n.expired||(this.clearTimeout(n.timeout),this.complete(n,!1,n.metaConnect),e.onFailure(n.xhr,e.messages,t))},i.send=function(e,n){n?function(e){if(null!==o)throw"Concurrent metaConnect requests not allowed, request id="+o.id+" not yet completed";var n=++r;this._debug("Transport",this.getType(),"metaConnect send, request",n,"envelope",e);var t={id:n,metaConnect:!0,envelope:e};u.call(this,e,t),o=t}.call(this,e):c.call(this,e)},i.abort=function(){t.abort();for(var e=0;e<s.length;++e){var n=s[e];n&&(this._debug("Aborting request",n),this.abortXHR(n.xhr)||this.transportFailure(n.envelope,n,{reason:"abort"}))}var i=o;i&&(this._debug("Aborting metaConnect request",i),this.abortXHR(i.xhr)||this.transportFailure(i.envelope,i,{reason:"abort"})),this.reset(!0)},i.reset=function(e){t.reset(e),o=null,s=[],a=[]},i.abortXHR=function(e){if(e)try{var n=e.readyState;return e.abort(),n!==window.XMLHttpRequest.UNSENT}catch(e){this._debug(e)}return!1},i.xhrStatus=function(e){if(e)try{return e.status}catch(e){this._debug(e)}return-1},i},i=function(){var e=new t,i=n.derive(e),r=!0;return i.accept=function(e,n,t){return r||!n},i.newXMLHttpRequest=function(){return new window.XMLHttpRequest},i.xhrSend=function(e){var n=i.newXMLHttpRequest();n.context=i.context,n.withCredentials=!0,n.open("POST",e.url,!0!==e.sync);var t=e.headers;if(t)for(var r in t)t.hasOwnProperty(r)&&n.setRequestHeader(r,t[r]);return n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.onload=function(){200===n.status?e.onSuccess(n.responseText):e.onError(n.statusText)},n.onerror=function(){e.onError(n.statusText)},n.send(e.body),n},i.transportSend=function(e,n){this._debug("Transport",this.getType(),"sending request",n.id,"envelope",e);var t=this;try{var i=!0;n.xhr=this.xhrSend({transport:this,url:e.url,sync:e.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(e.messages),onSuccess:function(i){t._debug("Transport",t.getType(),"received response",i);var o=!1;try{var s=t.convertToMessages(i);0===s.length?(r=!1,t.transportFailure(e,n,{httpCode:204})):(o=!0,t.transportSuccess(e,n,s))}catch(i){if(t._debug(i),!o){r=!1;var a={exception:i};a.httpCode=t.xhrStatus(n.xhr),t.transportFailure(e,n,a)}}},onError:function(o,s){t._debug("Transport",t.getType(),"received error",o,s),r=!1;var a={reason:o,exception:s};a.httpCode=t.xhrStatus(n.xhr),i?t.setTimeout(function(){t.transportFailure(e,n,a)},0):t.transportFailure(e,n,a)}}),i=!1}catch(i){r=!1,this.setTimeout(function(){t.transportFailure(e,n,{exception:i})},0)}},i.reset=function(n){e.reset(n),r=!0},i},r=function(){var e=new t,i=n.derive(e),r=0;function o(e,n,t){var i=this;return function(){i.transportFailure(e,n,"error",t)}}return i.accept=function(e,n,t){return!0},i.jsonpSend=function(e){var n=document.getElementsByTagName("head")[0],t=document.createElement("script"),i="_cometd_jsonp_"+r++;window[i]=function(r){n.removeChild(t),delete window[i],e.onSuccess(r)};var o=e.url;o+=o.indexOf("?")<0?"?":"&",o+="jsonp="+i,o+="&message="+encodeURIComponent(e.body),t.src=o,t.async=!0!==e.sync,t.type="application/javascript",t.onerror=function(n){e.onError("jsonp "+n.type)},n.appendChild(t)},i.transportSend=function(e,n){for(var t=this,i=0,r=e.messages.length,s=[];r>0;){var a=JSON.stringify(e.messages.slice(i,i+r)),u=e.url.length+encodeURI(a).length,c=this.getConfiguration().maxURILength;if(u>c){if(1===r){var l="Bayeux message too big ("+u+" bytes, max is "+c+") for transport "+this.getType();return void this.setTimeout(o.call(this,e,n,l),0)}--r}else s.push(r),i+=r,r=e.messages.length-i}var f=e;if(s.length>1){var d=0,h=s[0];this._debug("Transport",this.getType(),"split",e.messages.length,"messages into",s.join(" + ")),(f=this._mixin(!1,{},e)).messages=e.messages.slice(d,h),f.onSuccess=e.onSuccess,f.onFailure=e.onFailure;for(var g=1;g<s.length;++g){var b=this._mixin(!1,{},e);d=h,h+=s[g],b.messages=e.messages.slice(d,h),b.onSuccess=e.onSuccess,b.onFailure=e.onFailure,this.send(b,n.metaConnect)}}this._debug("Transport",this.getType(),"sending request",n.id,"envelope",f);try{var p=!0;this.jsonpSend({transport:this,url:f.url,sync:f.sync,headers:this.getConfiguration().requestHeaders,body:JSON.stringify(f.messages),onSuccess:function(e){var i=!1;try{var r=t.convertToMessages(e);0===r.length?t.transportFailure(f,n,{httpCode:204}):(i=!0,t.transportSuccess(f,n,r))}catch(e){t._debug(e),i||t.transportFailure(f,n,{exception:e})}},onError:function(e,i){var r={reason:e,exception:i};p?t.setTimeout(function(){t.transportFailure(f,n,r)},0):t.transportFailure(f,n,r)}}),p=!1}catch(e){this.setTimeout(function(){t.transportFailure(f,n,{exception:e})},0)}},i},o=function(){var t,i=new n,r=n.derive(i),o=!0,s=!1,a=!0,u=null,c=null,l=!1,f=null;function d(e,n){e&&(this.webSocketClose(e,n.code,n.reason),this.onClose(e,n))}function h(e){return e===c||e===u}function g(e,n,t){for(var i=[],r=0;r<n.messages.length;++r){var o=n.messages[r];o.id&&i.push(o.id)}e.envelopes[i.join(",")]=[n,t],this._debug("Transport",this.getType(),"stored envelope, envelopes",e.envelopes)}function b(e,n,i){var r=JSON.stringify(n.messages);e.webSocket.send(r),this._debug("Transport",this.getType(),"sent",n,"metaConnect =",i);var o=this.getConfiguration().maxNetworkDelay,s=o;i&&(s+=this.getAdvice().timeout,l=!0);for(var a=this,u=[],c=0;c<n.messages.length;++c)!function(){var i=n.messages[c];i.id&&(u.push(i.id),e.timeouts[i.id]=a.setTimeout(function(){t._debug("Transport",a.getType(),"timing out message",i.id,"after",s,"on",e),d.call(a,e,{code:1e3,reason:"Message Timeout"})},s))}();this._debug("Transport",this.getType(),"waiting at most",s,"ms for messages",u,"maxNetworkDelay",o,", timeouts:",e.timeouts)}function p(e,n,i){try{null===e?(e=c||{envelopes:{},timeouts:{}},g.call(this,e,n,i),function(e){if(!c){var n=t.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",n);try{var i=t.getConfiguration().protocol;e.webSocket=i?new window.WebSocket(n,i):new window.WebSocket(n),c=e}catch(e){throw o=!1,this._debug("Exception while creating WebSocket object",e),e}a=!1!==t.getConfiguration().stickyReconnect;var r=this,l=t.getConfiguration().connectTimeout;l>0&&(e.connectTimer=this.setTimeout(function(){t._debug("Transport",r.getType(),"timed out while connecting to URL",n,":",l,"ms"),d.call(r,e,{code:1e3,reason:"Connect Timeout"})},l));var f=function(n){n=n||{code:1e3},t._debug("WebSocket onclose",e,n,"connecting",c,"current",u),e.connectTimer&&r.clearTimeout(e.connectTimer),r.onClose(e,n)};e.webSocket.onopen=function(){t._debug("WebSocket onopen",e),e.connectTimer&&r.clearTimeout(e.connectTimer),h(e)?(c=null,u=e,s=!0,r.onOpen(e)):(t._warn("Closing extra WebSocket connection",this,"active connection",u),d.call(r,e,{code:1e3,reason:"Extra Connection"}))},e.webSocket.onclose=f,e.webSocket.onerror=function(){f({code:1e3,reason:"Error"})},e.webSocket.onmessage=function(n){t._debug("WebSocket onmessage",n,e),r.onMessage(e,n)},this._debug("Transport",this.getType(),"configured callbacks on",e)}}.call(this,e)):(g.call(this,e,n,i),b.call(this,e,n,i))}catch(n){var r=this;this.setTimeout(function(){d.call(r,e,{code:1e3,reason:"Exception",exception:n})},0)}}return r.reset=function(e){i.reset(e),o=!0,e&&(s=!1),a=!0,u=null,c=null,l=!1},r._notifySuccess=function(e,n){e.call(this,n)},r._notifyFailure=function(e,n,t,i){e.call(this,n,t,i)},r.onOpen=function(e){var n=e.envelopes;for(var t in this._debug("Transport",this.getType(),"opened",e,"pending messages",n),n)if(n.hasOwnProperty(t)){var i=n[t],r=i[0],o=i[1];f=r.onSuccess,b.call(this,e,r,o)}},r.onMessage=function(n,t){this._debug("Transport",this.getType(),"received websocket message",t,n);for(var i=!1,r=this.convertToMessages(t.data),o=[],s=0;s<r.length;++s){var a=r[s];if((/^\/meta\//.test(a.channel)||void 0===a.data)&&a.id){o.push(a.id);var u=n.timeouts[a.id];u&&(this.clearTimeout(u),delete n.timeouts[a.id],this._debug("Transport",this.getType(),"removed timeout for message",a.id,", timeouts",n.timeouts))}"/meta/connect"===a.channel&&(l=!1),"/meta/disconnect"!==a.channel||l||(i=!0)}for(var c=!1,d=n.envelopes,h=0;h<o.length;++h){var g=o[h];for(var b in d)if(d.hasOwnProperty(b)){var p=b.split(","),v=e.inArray(g,p);if(v>=0){c=!0,p.splice(v,1);var m=d[b][0],y=d[b][1];delete d[b],p.length>0&&(d[p.join(",")]=[m,y]);break}}}c&&this._debug("Transport",this.getType(),"removed envelope, envelopes",d),this._notifySuccess(f,r),i&&this.webSocketClose(n,1e3,"Disconnect")},r.onClose=function(e,n){this._debug("Transport",this.getType(),"closed",e,n),h(e)&&(o=a&&s,c=null,u=null);var t=e.timeouts;for(var i in e.timeouts={},t)t.hasOwnProperty(i)&&this.clearTimeout(t[i]);var r=e.envelopes;for(var f in e.envelopes={},r)if(r.hasOwnProperty(f)){var d=r[f][0];r[f][1]&&(l=!1);var g={websocketCode:n.code,reason:n.reason};n.exception&&(g.exception=n.exception),this._notifyFailure(d.onFailure,e,d.messages,g)}},r.registered=function(e,n){i.registered(e,n),t=n},r.accept=function(e,n,i){return this._debug("Transport",this.getType(),"accept, supported:",o),o&&!!window.WebSocket&&!1!==t.websocketEnabled},r.send=function(e,n){this._debug("Transport",this.getType(),"sending",e,"metaConnect =",n),p.call(this,u,e,n)},r.webSocketClose=function(e,n,t){try{e.webSocket&&e.webSocket.close(n,t)}catch(e){this._debug(e)}},r.abort=function(){i.abort(),d.call(this,u,{code:1e3,reason:"Abort"}),this.reset(!0)},r},s=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",".","-",":","+","=","^","!","/","*","?","&","<",">","(",")","[","]","{","}","@","%","$","#"],a=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0];return{CometD:function(n){var t,s,a,u,c,l=this,f=n||"default",d=!1,h=new function(){var e=[],n={};this.getTransportTypes=function(){return e.slice(0)},this.findTransportTypes=function(t,i,r){for(var o=[],s=0;s<e.length;++s){var a=e[s];!0===n[a].accept(t,i,r)&&o.push(a)}return o},this.negotiateTransport=function(t,i,r,o){for(var s=0;s<e.length;++s)for(var a=e[s],u=0;u<t.length;++u)if(a===t[u]){var c=n[a];if(!0===c.accept(i,r,o))return c}return null},this.add=function(t,i,r){for(var o=!1,s=0;s<e.length;++s)if(e[s]===t){o=!0;break}return o||("number"!=typeof r?e.push(t):e.splice(r,0,t),n[t]=i),!o},this.find=function(t){for(var i=0;i<e.length;++i)if(e[i]===t)return n[t];return null},this.remove=function(t){for(var i=0;i<e.length;++i)if(e[i]===t){e.splice(i,1);var r=n[t];return delete n[t],r}return null},this.clear=function(){e=[],n={}},this.reset=function(t){for(var i=0;i<e.length;++i)n[e[i]].reset(t)}},g="disconnected",b=0,p=null,v=0,m=[],y=!1,_=0,C={},w=0,T=null,S=[],E={},x={},k={},O=!1,I=!1,N=0,L=0,M={protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,urls:{},maxURILength:2e3,advice:{timeout:6e4,interval:0,reconnect:void 0,maxInterval:0}};function D(e,n){try{return e[n]}catch(e){return}}function R(n){return e.isString(n)}function A(e){return void 0!==e&&null!==e&&"function"==typeof e}function F(e,n){for(var t="";--n>0&&!(e>=Math.pow(10,n));)t+="0";return t+=e}function B(e,n){if(window.console){var t=window.console[e];if(A(t)){var i=new Date;[].splice.call(n,0,0,F(i.getHours(),2)+":"+F(i.getMinutes(),2)+":"+F(i.getSeconds(),2)+"."+F(i.getMilliseconds(),3)),t.apply(window.console,n)}}}function U(e){return/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(e)}function P(e){if(e){var n=C[e.channel];n&&n[e.id]&&(delete n[e.id],l._debug("Removed",e.listener?"listener":"subscription",e))}}function j(e){e&&!e.listener&&P(e)}function q(){for(var e in C)if(C.hasOwnProperty(e)){var n=C[e];if(n)for(var t in n)n.hasOwnProperty(t)&&j(n[t])}}function G(e){g!==e&&(l._debug("Status",g,"->",e),g=e)}function W(){return"disconnecting"===g||"disconnected"===g}function H(){return""+ ++b}function z(e,n,t,i,r){try{return n.call(e,i)}catch(e){var o=l.onExtensionException;if(A(o)){l._debug("Invoking extension exception handler",t,e);try{o.call(l,e,t,r,i)}catch(e){l._info("Exception during execution of extension exception handler",t,e)}}else l._info("Exception during execution of extension",t,e);return i}}function Q(e){for(var n=S.length-1;n>=0&&void 0!==e&&null!==e;--n){var t=S[n],i=t.extension.outgoing;if(A(i)){var r=z(t.extension,i,t.name,e,!0);e=void 0===r?e:r}}return e}function X(e,n){var t=C[e];if(t)for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];if(r)try{r.callback.call(r.scope,n)}catch(e){var o=l.onListenerException;if(A(o)){l._debug("Invoking listener exception handler",r,e);try{o.call(l,e,r,r.listener,n)}catch(e){l._info("Exception during execution of listener exception handler",r,e)}}else l._info("Exception during execution of listener",r,n,e)}}}function V(e,n){X(e,n);for(var t=e.split("/"),i=t.length-1,r=i;r>0;--r){var o=t.slice(0,r).join("/")+"/*";r===i&&X(o,n),X(o+="*",n)}}function K(){null!==T&&e.clearTimeout(T),T=null}function J(n,t){K();var i=E.interval+t;l._debug("Function scheduled in",i,"ms, interval =",E.interval,"backoff =",w,n),T=e.setTimeout(l,n,i)}function Y(e,n,i,r){for(var o=0;o<n.length;++o){var s=n[o],a=s.id;p&&(s.clientId=p),void 0!==(s=Q(s))&&null!==s?(s.id=a,n[o]=s):(delete x[a],n.splice(o--,1))}if(0!==n.length){var f=l.getURL();M.appendMessageTypeToURL&&(f.match(/\/$/)||(f+="/"),r&&(f+=r));var d={url:f,sync:e,messages:n,onSuccess:function(e){try{u.call(l,e)}catch(e){l._info("Exception during handling of messages",e)}},onFailure:function(e,n,t){try{var i=l.getTransport();t.connectionType=i?i.getType():"unknown",c.call(l,e,n,t)}catch(e){l._info("Exception during handling of failure",e)}}};l._debug("Send",d),t.send(d,i)}}function Z(e){v>0||!0===y?m.push(e):Y(!1,[e],!1)}function $(){w=0}function ee(){var e=m;m=[],e.length>0&&Y(!1,e,!1)}function ne(e){G("connecting"),J(function(){!function(){if(!W()){var e={id:H(),channel:"/meta/connect",connectionType:t.getType()};I||(e.advice={timeout:0}),G("connecting"),l._debug("Connect sent",e),Y(!1,[e],!0,"connect"),G("connected")}}()},e)}function te(e){e&&(E=l._mixin(!1,{},M.advice,e),l._debug("New advice",E))}function ie(e){if(K(),e&&t&&t.abort(),p=null,G("disconnected"),v=0,$(),t=null,O=!1,I=!1,m.length>0){var n=m;m=[],c.call(l,void 0,n,{reason:"Disconnected"})}}function re(e,n,t){var i=l.onTransportException;if(A(i)){l._debug("Invoking transport exception handler",e,n,t);try{i.call(l,t,e,n)}catch(e){l._info("Exception during execution of transport exception handler",e)}}}function oe(e,n){A(e)&&(n=e,e=void 0),p=null,q(),W()&&h.reset(!0),te({}),v=0,y=!0,s=e,a=n;var i=l.getURL(),r=h.findTransportTypes("1.0",d,i),o={id:H(),version:"1.0",minimumVersion:"1.0",channel:"/meta/handshake",supportedConnectionTypes:r,advice:{timeout:E.timeout,interval:E.interval}},u=l._mixin(!1,{},s,o);if(l._putCallback(u.id,n),!t&&!(t=h.negotiateTransport(r,"1.0",d,i))){var c="Could not find initial transport among: "+h.getTransportTypes();throw l._warn(c),c}l._debug("Initial transport is",t.getType()),G("handshaking"),l._debug("Handshake sent",u),Y(!1,[u],!1,"handshake")}function se(e,n){try{e.call(l,n)}catch(e){var t=l.onCallbackException;if(A(t)){l._debug("Invoking callback exception handler",e);try{t.call(l,e,n)}catch(e){l._info("Exception during execution of callback exception handler",e)}}else l._info("Exception during execution of message callback",e)}}function ae(e){var n=l._getCallback([e.id]);A(n)&&(delete x[e.id],se(n,e))}function ue(n){var t=k[n.id];if(delete k[n.id],t){l._debug("Handling remote call response for",n,"with context",t);var i=t.timeout;i&&e.clearTimeout(i);var r=t.callback;if(A(r))return se(r,n),!0}return!1}function ce(e){l._debug("Transport failure handling",e),e.transport&&(t=e.transport),e.url&&t.setURL(e.url);var n=e.action,i=e.delay||0;switch(n){case"handshake":!function(e){G("handshaking"),y=!0,J(function(){oe(s,a)},e)}(i);break;case"retry":ne(i);break;case"none":ie(!0);break;default:throw"Unknown action "+n}}function le(e,n){ae(e),V("/meta/handshake",e),V("/meta/unsuccessful",e),W()&&(n.action="none"),l.onTransportFailure.call(l,e,n,ce)}function fe(e){le(e,{cause:"failure",action:"handshake",transport:null})}function de(e,n){V("/meta/connect",e),V("/meta/unsuccessful",e),W()&&(n.action="none"),l.onTransportFailure.call(l,e,n,ce)}function he(e){I=!1,de(e,{cause:"failure",action:"retry",transport:null})}function ge(e){ie(!0),ae(e),V("/meta/disconnect",e),V("/meta/unsuccessful",e)}function be(e){ge(e)}function pe(e){var n=C[e.subscription];if(n)for(var t in n)if(n.hasOwnProperty(t)){var i=n[t];i&&!i.listener&&(delete n[t],l._debug("Removed failed subscription",i))}ae(e),V("/meta/subscribe",e),V("/meta/unsuccessful",e)}function ve(e){pe(e)}function me(e){ae(e),V("/meta/unsubscribe",e),V("/meta/unsuccessful",e)}function ye(e){me(e)}function _e(e){ue(e)||(ae(e),V("/meta/publish",e),V("/meta/unsuccessful",e))}function Ce(e){_e(e)}function we(e){if(N=0,void 0!==(e=function(e){for(var n=0;n<S.length&&void 0!==e&&null!==e;++n){var t=S[n],i=t.extension.incoming;if(A(i)){var r=z(t.extension,i,t.name,e,!1);e=void 0===r?e:r}}return e}(e))&&null!==e)switch(te(e.advice),e.channel){case"/meta/handshake":!function(e){var n=l.getURL();if(e.successful){var i=l._isCrossDomain(U(n)[2]),r=h.negotiateTransport(e.supportedConnectionTypes,e.version,i,n);if(null===r)return e.successful=!1,void le(e,{cause:"negotiation",action:"none",transport:null});t!==r&&(l._debug("Transport",t.getType(),"->",r.getType()),t=r),p=e.clientId,y=!1,ee(),e.reestablish=O,O=!0,ae(e),V("/meta/handshake",e),L=e["x-messages"]||0;var o=W()?"none":E.reconnect||"retry";switch(o){case"retry":$(),0===L?ne(0):l._debug("Processing",L,"handshake-delivered messages");break;case"none":ie(!0);break;default:throw"Unrecognized advice action "+o}}else le(e,{cause:"unsuccessful",action:E.reconnect||"handshake",transport:t})}(e);break;case"/meta/connect":!function(e){if(I=e.successful){V("/meta/connect",e);var n=W()?"none":E.reconnect||"retry";switch(n){case"retry":$(),ne(w);break;case"none":ie(!1);break;default:throw"Unrecognized advice action "+n}}else de(e,{cause:"unsuccessful",action:E.reconnect||"retry",transport:t})}(e);break;case"/meta/disconnect":!function(e){e.successful?(ie(!1),ae(e),V("/meta/disconnect",e)):ge(e)}(e);break;case"/meta/subscribe":!function(e){e.successful?(ae(e),V("/meta/subscribe",e)):pe(e)}(e);break;case"/meta/unsubscribe":!function(e){e.successful?(ae(e),V("/meta/unsubscribe",e)):me(e)}(e);break;default:!function(e){void 0!==e.data?ue(e)||(V(e.channel,e),L>0&&0==--L&&(l._debug("Processed last handshake-delivered message"),ne(0))):void 0===e.successful?l._warn("Unknown Bayeux Message",e):e.successful?(ae(e),V("/meta/publish",e)):_e(e)}(e)}}function Te(e){var n=C[e];if(n)for(var t in n)if(n.hasOwnProperty(t)&&n[t])return!0;return!1}function Se(e,n){var t={scope:e,method:n};if(A(e))t.scope=void 0,t.method=e;else if(R(n)){if(!e)throw"Invalid scope "+e;if(t.method=e[n],!A(t.method))throw"Invalid callback "+n+" for scope "+e}else if(!A(n))throw"Invalid callback "+n;return t}function Ee(e,n,t,i){var r=Se(n,t);l._debug("Adding",i?"listener":"subscription","on",e,"with scope",r.scope,"and callback",r.method);var o=++_,s={id:o,channel:e,scope:r.scope,callback:r.method,listener:i},a=C[e];return a||(a={},C[e]=a),a[o]=s,l._debug("Added",i?"listener":"subscription",s),s}this._mixin=function(e,n,t){for(var i=n||{},r=2;r<arguments.length;++r){var o=arguments[r];if(void 0!==o&&null!==o)for(var s in o)if(o.hasOwnProperty(s)){var a=D(o,s),u=D(i,s);if(a===n)continue;if(void 0===a)continue;if(e&&"object"==typeof a&&null!==a)if(a instanceof Array)i[s]=this._mixin(e,u instanceof Array?u:[],a);else{var c="object"!=typeof u||u instanceof Array?{}:u;i[s]=this._mixin(e,c,a)}else i[s]=a}}return i},this._warn=function(){B("warn",arguments)},this._info=function(){"warn"!==M.logLevel&&B("info",arguments)},this._debug=function(){"debug"===M.logLevel&&B("debug",arguments)},this._isCrossDomain=function(e){return!!(window.location&&window.location.host&&e)&&e!==window.location.host},this.send=Z,this._getCallback=function(e){return x[e]},this._putCallback=function(e,n){var t=this._getCallback(e);return A(n)&&(x[e]=n),t},this.onTransportFailure=function(e,n,i){this._debug("Transport failure",n,"for",e);var r=this.getTransportRegistry(),o=this.getURL(),s=this._isCrossDomain(U(o)[2]),a=r.findTransportTypes("1.0",s,o);if("none"===n.action){if("/meta/handshake"===e.channel&&!n.transport){var u="Could not negotiate transport, client=["+a+"], server=["+e.supportedConnectionTypes+"]";this._warn(u),re(t.getType(),null,{reason:u,connectionType:t.getType(),transport:t})}}else if(n.delay=this.getBackoffPeriod(),"/meta/handshake"===e.channel){if(!n.transport){var c=r.negotiateTransport(a,"1.0",s,o);c?(this._debug("Transport",t.getType(),"->",c.getType()),re(t.getType(),c.getType(),e.failure),n.action="handshake",n.transport=c):(this._warn("Could not negotiate transport, client=["+a+"]"),re(t.getType(),null,e.failure),n.action="none")}"none"!==n.action&&this.increaseBackoffPeriod()}else{var f=(new Date).getTime();if(0===N&&(N=f),"retry"===n.action){n.delay=this.increaseBackoffPeriod();var d=E.maxInterval;if(d>0){var h=E.timeout+E.interval+d;f-N+w>h&&(n.action="handshake")}}"handshake"===n.action&&(n.delay=0,r.reset(!1),this.resetBackoffPeriod())}i.call(l,n)},this.receive=we,u=function(e){l._debug("Received",e);for(var n=0;n<e.length;++n)we(e[n])},c=function(e,n,t){l._debug("handleFailure",e,n,t),t.transport=e;for(var i=0;i<n.length;++i){var r=n[i],o={id:r.id,successful:!1,channel:r.channel,failure:t};switch(t.message=r,r.channel){case"/meta/handshake":fe(o);break;case"/meta/connect":he(o);break;case"/meta/disconnect":be(o);break;case"/meta/subscribe":o.subscription=r.subscription,ve(o);break;case"/meta/unsubscribe":o.subscription=r.subscription,ye(o);break;default:Ce(o)}}},this.registerTransport=function(e,n,t){var i=h.add(e,n,t);return i&&(this._debug("Registered transport",e),A(n.registered)&&n.registered(e,this)),i},this.unregisterTransport=function(e){var n=h.remove(e);return null!==n&&(this._debug("Unregistered transport",e),A(n.unregistered)&&n.unregistered()),n},this.unregisterTransports=function(){h.clear()},this.getTransportTypes=function(){return h.getTransportTypes()},this.findTransport=function(e){return h.find(e)},this.getTransportRegistry=function(){return h},this.configure=function(e){(function(e){l._debug("Configuring cometd object with",e),R(e)&&(e={url:e}),e||(e={}),M=l._mixin(!1,M,e);var n=l.getURL();if(!n)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var t=U(n),i=t[2],r=t[8],o=t[9];if(d=l._isCrossDomain(i),M.appendMessageTypeToURL)if(void 0!==o&&o.length>0)l._info("Appending message type to URI "+r+o+" is not supported, disabling 'appendMessageTypeToURL' configuration"),M.appendMessageTypeToURL=!1;else{var s=r.split("/"),a=s.length-1;r.match(/\/$/)&&(a-=1),s[a].indexOf(".")>=0&&(l._info("Appending message type to URI "+r+" is not supported, disabling 'appendMessageTypeToURL' configuration"),M.appendMessageTypeToURL=!1)}}).call(this,e)},this.init=function(e,n){this.configure(e),this.handshake(n)},this.handshake=function(e,n){if("disconnected"!==g)throw"Illegal state: handshaken";oe(e,n)},this.disconnect=function(e,n,t){if(!W()){"boolean"!=typeof e&&(t=n,n=e,e=!1),A(n)&&(t=n,n=void 0);var i={id:H(),channel:"/meta/disconnect"},r=this._mixin(!1,{},n,i);l._putCallback(r.id,t),G("disconnecting"),Y(!0===e,[r],!1,"disconnect")}},this.startBatch=function(){++v,l._debug("Starting batch, depth",v)},this.endBatch=function(){!function(){if(--v,l._debug("Ending batch, depth",v),v<0)throw"Calls to startBatch() and endBatch() are not paired";0!==v||W()||y||ee()}()},this.batch=function(e,n){var t=Se(e,n);this.startBatch();try{t.method.call(t.scope),this.endBatch()}catch(e){throw this._info("Exception during execution of batch",e),this.endBatch(),e}},this.addListener=function(e,n,t){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!R(e))throw"Illegal argument type: channel must be a string";return Ee(e,n,t,!0)},this.removeListener=function(e){if(!(e&&e.channel&&"id"in e))throw"Invalid argument: expected subscription, not "+e;P(e)},this.clearListeners=function(){C={}},this.subscribe=function(e,n,t,i,r){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!R(e))throw"Illegal argument type: channel must be a string";if(W())throw"Illegal state: disconnected";A(n)&&(r=i,i=t,t=n,n=void 0),A(i)&&(r=i,i=void 0);var o=!Te(e),s=Ee(e,n,t,!1);if(o){var a={id:H(),channel:"/meta/subscribe",subscription:e},u=this._mixin(!1,{},i,a);l._putCallback(u.id,r),Z(u)}return s},this.unsubscribe=function(e,n,t){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(W())throw"Illegal state: disconnected";A(n)&&(t=n,n=void 0),this.removeListener(e);var i=e.channel;if(!Te(i)){var r={id:H(),channel:"/meta/unsubscribe",subscription:i},o=this._mixin(!1,{},n,r);l._putCallback(o.id,t),Z(o)}},this.resubscribe=function(e,n){if(j(e),e)return this.subscribe(e.channel,e.scope,e.callback,n)},this.clearSubscriptions=function(){q()},this.publish=function(e,n,t,i){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!R(e))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(e))throw"Illegal argument: cannot publish to meta channels";if(W())throw"Illegal state: disconnected";A(n)?(i=n,n={},t=void 0):A(t)&&(i=t,t=void 0);var r={id:H(),channel:e,data:n},o=this._mixin(!1,{},t,r);l._putCallback(o.id,i),Z(o)},this.publishBinary=function(e,n,t,i,r){A(n)?(r=n,n=new ArrayBuffer(0),t=!0,i=void 0):A(t)?(r=t,t=!0,i=void 0):A(i)&&(r=i,i=void 0);var o={meta:i,data:n,last:t};this.publish(e,o,{ext:{binary:{}}},r)},this.remoteCall=function(n,t,i,r,o){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!R(n))throw"Illegal argument type: target must be a string";if(W())throw"Illegal state: disconnected";if(A(t)?(o=t,t={},i=M.maxNetworkDelay,r=void 0):A(i)?(o=i,i=M.maxNetworkDelay,r=void 0):A(r)&&(o=r,r=void 0),"number"!=typeof i)throw"Illegal argument type: timeout must be a number";n.match(/^\//)||(n="/"+n);var s="/service"+n,a={id:H(),channel:s,data:t},u=this._mixin(!1,{},r,a),c={callback:o};i>0&&(c.timeout=e.setTimeout(l,function(){l._debug("Timing out remote call",u,"after",i,"ms"),_e({id:u.id,error:"406::timeout",successful:!1,failure:{message:u,reason:"Remote Call Timeout"}})},i),l._debug("Scheduled remote call timeout",u,"in",i,"ms")),k[u.id]=c,Z(u)},this.remoteCallBinary=function(e,n,t,i,r,o){A(n)?(o=n,n=new ArrayBuffer(0),t=!0,i=void 0,r=M.maxNetworkDelay):A(t)?(o=t,t=!0,i=void 0,r=M.maxNetworkDelay):A(i)?(o=i,i=void 0,r=M.maxNetworkDelay):A(r)&&(o=r,r=M.maxNetworkDelay);var s={meta:i,data:n,last:t};this.remoteCall(e,s,r,{ext:{binary:{}}},o)},this.getStatus=function(){return g},this.isDisconnected=W,this.setBackoffIncrement=function(e){M.backoffIncrement=e},this.getBackoffIncrement=function(){return M.backoffIncrement},this.getBackoffPeriod=function(){return w},this.increaseBackoffPeriod=function(){return w<M.maxBackoff&&(w+=M.backoffIncrement),w},this.resetBackoffPeriod=function(){$()},this.setLogLevel=function(e){M.logLevel=e},this.registerExtension=function(e,n){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!R(e))throw"Illegal argument type: extension name must be a string";for(var t=!1,i=0;i<S.length;++i)if(S[i].name===e){t=!0;break}return t?(this._info("Could not register extension with name",e,"since another extension with the same name already exists"),!1):(S.push({name:e,extension:n}),this._debug("Registered extension",e),A(n.registered)&&n.registered(e,this),!0)},this.unregisterExtension=function(e){if(!R(e))throw"Illegal argument type: extension name must be a string";for(var n=!1,t=0;t<S.length;++t){var i=S[t];if(i.name===e){S.splice(t,1),n=!0,this._debug("Unregistered extension",e);var r=i.extension;A(r.unregistered)&&r.unregistered();break}}return n},this.getExtension=function(e){for(var n=0;n<S.length;++n){var t=S[n];if(t.name===e)return t.extension}return null},this.getName=function(){return f},this.getClientId=function(){return p},this.getURL=function(){if(t){var e=t.getURL();if(e)return e;if(e=M.urls[t.getType()])return e}return M.url},this.getTransport=function(){return t},this.getConfiguration=function(){return this._mixin(!0,{},M)},this.getAdvice=function(){return this._mixin(!0,{},E)},window.WebSocket&&this.registerTransport("websocket",new o),this.registerTransport("long-polling",new i),this.registerTransport("callback-polling",new r)},Transport:n,RequestTransport:t,LongPollingTransport:i,CallbackPollingTransport:r,WebSocketTransport:o,Utils:e,Z85:{encode:function(e){var n=null;if(e instanceof ArrayBuffer?n=e:e.buffer instanceof ArrayBuffer?n=e.buffer:Array.isArray(e)&&(n=new Uint8Array(e).buffer),null==n)throw"Cannot Z85 encode "+e;for(var t=n.byteLength,i=t%4,r=4-(0===i?4:i),o=new DataView(n),a="",u=0,c=0;c<t+r;++c){var l=c>=t;if(u=256*u+(l?0:o.getUint8(c)),(c+1)%4==0){for(var f=52200625,d=5;d>0;--d){if(!l||d>r){var h=Math.floor(u/f)%85;a+=s[h]}f/=85}u=0}}return a},decode:function(e){for(var n=e.length%5,t=5-(0===n?5:n),i=0;i<t;++i)e+=s[s.length-1];for(var r=e.length,o=new ArrayBuffer(4*r/5-t),u=new DataView(o),c=0,l=0,f=0,d=0;d<r;++d){var h=e.charCodeAt(l++)-32;if(c=85*c+a[h],l%5==0){for(var g=16777216;g>=1;)f<u.byteLength&&u.setUint8(f++,Math.floor(c/g)%256),g/=256;c=0}}return o}}}},e.exports=i()},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,r=(i=t(0))&&i.__esModule?i:{default:i};var o=function(){var e=new r.default("amb.GraphQLSubscriptionExtension"),n={};this.isGraphQLChannel=function(e){return e&&e.startsWith("/rw/graphql")},this.addGraphQLChannel=function(e,t){n[e]=t},this.removeGraphQLChannel=function(e){delete n[e]},this.getGraphQLSubscriptions=function(){return n},this.outgoing=function(t){return"/meta/subscribe"===t.channel&&this.isGraphQLChannel(t.subscription)&&(t.ext||(t.ext={}),n[t.subscription]&&(e.debug("Subscribing with GraphQL subscription:"+n[t.subscription]),t.ext.serializedGraphQLSubscription=n[t.subscription])),t}};n.default=o},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,r=(i=t(0))&&i.__esModule?i:{default:i};var o=function(){var e=new r.default("amb.SessionExtension"),n=!1;this.extendSession=function(){n=!0},this.outgoing=function(t){return"/meta/connect"===t.channel&&n&&(t.ext||(t.ext={}),e.debug("extendSession"),t.ext.extendSession=!0,n=!1),t}};n.default=o},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=o(t(0)),r=o(t(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){var e=new i.default("amb.TokenManagementExtension"),n="/meta/subscribe",t="/meta/unsubscribe",o="/meta/handshake",s=r.default.subscribeCommandsFlow.maxInflight,a=[];function u(e){return e.channel==n||e.channel==t}function c(){e.debug("notifyOnAvailabilityOfToken - current tokenCount: "+s);try{a.forEach(function(e){e()})}catch(n){e.addErrorMessage("notifyOnAvailabilityOfToken - failed to call tokenEventListeners. Error Details : "+n)}}this.updateTokenCount=function(e){s=e},this.refillTokens=function(){s=r.default.subscribeCommandsFlow.maxInflight,c(),e.debug("refillTokens -- tokenCount : "+s)},this.outgoing=function(e){return function(e){return e.channel===o}(e)&&(e.ext||(e.ext={}),e.ext.supportsSubscribeCommandFlow=!0),r.default.subscribeCommandsFlow.enable?(u(e)&&s>0&&s--,e):e},this.incoming=function(e){return r.default.subscribeCommandsFlow.enable?(u(e)?(s<r.default.subscribeCommandsFlow.maxInflight&&s++,c()):function(e){if(!e.ext)return!1;var n=e.ext.received_by_glide;return!!n&&n&&u(n)}(e)&&(e=null),e):e},this.getTokenCount=function(){return s},this.addTokenAvailabilityListener=function(n){n&&(e.debug("addTokenAvailabilityListener - tokenEventListener : "+n),a.push(n))},this.removeTokenAvailabilityListener=function(n){if(n){e.debug("removeTokenAvailabilityListener - tokenEventListener : "+n);var t=a.findIndex(function(e){return n===e});-1!==t&&(e.debug("removeTokenAvailabilityListener - removing listener at index : "+t),a.splice(t,1))}}};n.default=s},function(e,n,t){var i;i=function(e){return function(){var n=e,t=n.lib.WordArray;n.enc.Base64={stringify:function(e){var n=e.words,t=e.sigBytes,i=this._map;e.clamp();for(var r=[],o=0;o<t;o+=3)for(var s=(n[o>>>2]>>>24-o%4*8&255)<<16|(n[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|n[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<t;a++)r.push(i.charAt(s>>>6*(3-a)&63));var u=i.charAt(64);if(u)for(;r.length%4;)r.push(u);return r.join("")},parse:function(e){var n=e.length,i=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var o=0;o<i.length;o++)r[i.charCodeAt(o)]=o}var s=i.charAt(64);if(s){var a=e.indexOf(s);-1!==a&&(n=a)}return function(e,n,i){for(var r=[],o=0,s=0;s<n;s++)if(s%4){var a=i[e.charCodeAt(s-1)]<<s%4*2,u=i[e.charCodeAt(s)]>>>6-s%4*2;r[o>>>2]|=(a|u)<<24-o%4*8,o++}return t.create(r,o)}(e,n,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64},e.exports=i(t(10))},function(e,n,t){var i;i=function(e){return e.enc.Utf8},e.exports=i(t(10))},function(e,n,t){"use strict";function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"emit",function(e,n){window.localStorage.setItem(e,JSON.stringify(n)),window.localStorage.removeItem(e)}),i(this,"on",function(e,n){window.addEventListener("storage",function(t){var i=t.key,r=t.newValue;i===e&&r&&n(JSON.parse(r))})})};n.default=r},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:134217727,n=[],t=Math.max(1,Math.floor(e));return{enqueue:function(e){return this.getAvailableSpace()>0&&(n.push(e),!0)},enqueueMultiple:function(e){return this.getAvailableSpace()>=e.length&&(n=n.concat(e),!0)},dequeue:function(){var e;return n.length>0&&(e=n.shift()),e},dequeueMultiple:function(e){var t;return e>=0&&n.length>=e&&(t=[],e>0&&(t=n.slice(0,e),n=n.slice(e))),t},clear:function(){n=[]},getSize:function(){return n.length},getCapacity:function(){return t},getAvailableSpace:function(){return t-n.length},getQueueBuffer:function(){return n}}};n.default=i},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=s(t(1)),r=t(3),o=s(t(0));function s(e){return e&&e.__esModule?e:{default:e}}var a=function(e,n){var t={SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe"},s=202,a=429,u=3e5,c=new o.default("amb.SubscriptionCommandSender");n.addTokenAvailabilityListener(function(){w()});var l=!i.default.subscribeCommandsFlow.enable,f=null;function d(e,n,t){return Math.min(t,Math.max(n,e))}function h(){return n.getTokenCount()>=i.default.subscribeCommandsFlow.maxInflight}function g(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e||(0,r.isNil)(f)){var t=d(i.default.subscribeCommandsFlow.maxWait,0,u);c.debug("restartTimer - force: "+e+", timerObject : "+f+", timeInterval : "+t),b(),f=setTimeout(function(){f=null,c.debug("onTimer - stopping : "+l),l||(n.refillTokens(),w())},t)}}function b(){(0,r.isNil)(f)||(c.debug("stopTimer"),clearTimeout(f),f=null)}function p(){var e=parseInt(i.default.subscribeCommandsFlow.retryDelay.min);return e=d(e,0,u)}function v(e,n,o,s){var a;c.debug("scheduleRetry - channel : "+e.getName()+", triesLeft : "+n+", mode : "+o);var u=function(e){return d(i.default.subscribeCommandsFlow.retryDelay.increaseFactor*e,i.default.subscribeCommandsFlow.retryDelay.min,i.default.subscribeCommandsFlow.retryDelay.max)}(s);switch(o){case t.SUBSCRIBE:a=function(){return _(e,n,u)};break;case t.UNSUBSCRIBE:a=function(){return C(e,n,u)}}(0,r.isNil)(a)||setTimeout(a,s)}function m(e,t,i,r,o){c.debug("onResponse - response ".concat(JSON.stringify(e),", channel ").concat(JSON.stringify(t),", mode : ").concat(i,", \n\t\t\ttriesLeft ").concat(r,", stopping : ").concat(l,", tokenCount : ").concat(n.getTokenCount(),", isBucketFull - ").concat(h(),", retryDelay - ").concat(o)),l?t.subscriptionCallback(e):(r-=1,h()&&b(),r>0&&function(e){if(c.debug("isRetriable - response : "+e),e&&e.ext){var n=e.ext.rejected_by_glide;if(n){var t=parseInt(e.ext["glide.amb.reply.status.code"]);if(c.addWarnMessage("isRetriable - rejected_by_glide : "+n+", glide.amb.reply.status.code : "+t),!isNaN(t))return t==a||t==s}}return c.debug("isRetriable -  "+!1),!1}(e)?v(t,r,i,o):t.subscriptionCallback(e),w())}function y(n){return c.debug("addItemToQueue - item : "+n),!!e.enqueue(n)&&(w(),!0)}function _(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p();return c.debug("enqueueSubscribe - channel: "+e.getName()+", triesLeft : "+n+", stopping : "+l+", retryDelay : "+o),!!(!l&&(0,r.isObject)(e)&&((0,r.isNil)(n)&&(n=1+Math.floor(i.default.subscribeCommandsFlow.retries)),n>0))&&y(function(){c.debug("enqueueSubscribe - inside the item execution. Calling channel._subscribeToCometD - channel: "+e.getName()+", triesLeft : "+n),e._subscribeToCometD(function(i){return m(i,e,t.SUBSCRIBE,n,o)})})}function C(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p();return c.debug("enqueueUnsubscribe - channel: "+e.getName()+", triesLeft : "+n+", stopping : "+l+", retryDelay : "+o),!!(!l&&(0,r.isObject)(e)&&((0,r.isNil)(n)&&(n=1+Math.floor(i.default.subscribeCommandsFlow.retries)),n>0))&&y(function(){e._unsubscribeFromCometD(function(i){return m(i,e,t.UNSUBSCRIBE,n,o)})})}function w(){var t=Math.min(e.getSize(),d(n.getTokenCount(),0,i.default.subscribeCommandsFlow.maxInflight));c.debug("processQueue - numberToProcess : "+t),t>0&&(e.dequeueMultiple(t).forEach(function(e){return(0,r.isNil)(e)||e()}),g(!1))}return{subscribeToChannel:function(e){return c.debug("subscribeToChannel - to : "+e.getName()),_(e)},unsubscribeToChannel:function(e){return c.debug("unsubscribeToChannel - from : "+e.getName()),C(e)},stop:function(){c.debug("stop"),c.debug("signalStop - stopping : "+l),l||(l=!0,b(),e.clear())},isStopping:function(){return l},getQueue:function(){return e},isBucketEmpty:function(){return!h()},getTimerObject:function(){return f},getTokenCountFromTokenManager:function(){return n.getTokenCount()}}};n.default=a}])});
amb.getClient();
;
